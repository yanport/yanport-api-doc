post:
  tags:
    - Statistiques sur les biens similaires (ancien/neuf)
  summary: Centiles
  description: >-
    Permet de récupérer les percentiles des biens similaires.
    
    
    Par défaut, les biens détectés comme anormaux sont ignorés : `anomalyLevelMax=1`
        (voir les valeurs possibles dans le paramètre `anomalyValues`).


    Voir notre [article](https://www.yanport.com/blog/posts/detection-anomalies-dans-les-annonces-immobilieres)
    pour comprendre la détection d'anomalies dans les annonces immobilières.
  parameters:
    - name: id
      in: path
      required: true
      schema:
        type: string
  requestBody:
    required: true
    description: >-
      Formulaire pour récupérer les centiles des biens similaires.


      L'objet query permet de définir les paramètres de la requête de centiles (field, percentiles et reliability)
      ainsi que des filtres supplémentaires pour la recherche de biens similaires (propertySearchQuery). 
      Par exemple: date de publication, source, zone géographique, ...
    content:
      application/json:
        schema:
          type: object
          properties:
            size:
              type: integer
              minimum: 0
              maximum: 100
              default: 10
              description: Nombre de biens sur lesquels faire l'analyse
            zone:
              description: Zone de recherche des biens similaires
              type: string
              enum:
                - IRIS
                - CITY
            weights:
              type: array
              items:
                $ref: ../components/schemas/Weight.yaml
            query:
              type: object
              properties:
                field:
                  $ref: ../components/schemas/Field-Numeric-Property.yaml
                percentiles:
                  type: array
                  description: Percentiles
                  example:
                    - '10.0'
                    - '50.0'
                    - '90.0'
                  items:
                    type: number
                    format: double
                reliability:
                  description: Renvoie un score de fiabilité entre 0 et 100, avec le score de chaque méthode utilisée
                  type: boolean
                  default: false
                searchQuery:
                  $ref: ../components/schemas/PropertySearchQuery.yaml
  responses:
    '200':
      description: Percentiles
      content:
        application/json:
          schema:
            $ref: ../components/schemas/Percentiles.yaml
    '400':
      $ref: ../components/responses/BadRequest.yaml
    '500':
      $ref: ../components/responses/InternalServerError.yaml
